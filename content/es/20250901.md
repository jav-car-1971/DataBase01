---
title: "Configurando una app web con Docker"
date: 2025-09-01T22:16:23-03:00
draft: false
tags: ["docker", "docker-compose", "python", "flask", "postgresql"]
categories: ["Proyectos"]
author: "JavCar1971"
description: "Documentación del proceso para configurar y ejecutar una aplicación web simple en Python con una base de datos PostgreSQL, ambas en contenedores Docker."
---

## Proyecto

Este es un proyecto ideal para empezar con Docker porque te enseña a manejar múltiples contenedores que se comunican entre sí, lo cual es fundamental para proyectos más grandes.

**Objetivo:** Crear una aplicación web simple en Python con una base de datos PostgreSQL, ambas corriendo en contenedores separados.

**Componentes:**

* **Contenedor 1 (Aplicación Web):** Contendrá el código de la aplicación Python y sus dependencias. Usaríamos un archivo **`Dockerfile`** para definir cómo construir la imagen de este contenedor.  
* **Contenedor 2 (Base de Datos):** Usaríamos una imagen oficial de **PostgreSQL** para que la aplicación guarde sus datos.  
* **Archivo `docker-compose.yml`:** Este archivo es el más importante del proyecto. Va a definir los dos servicios (`app` y `db`), cómo se conectan, qué puertos usan y cómo se levantan juntos con un solo comando.

**Pasos Conceptuales:**

1. **Estructura del Proyecto:** Crear las carpetas y los archivos necesarios: una carpeta para la aplicación, el `Dockerfile`, el `requirements.txt` y el archivo `docker-compose.yml`.  
2. **Definición de Contenedores:** Escribir el `Dockerfile` para la aplicación web y el `docker-compose.yml` para definir ambos servicios y sus configuraciones.  
3. **Construcción y Lanzamiento:** Usar el comando `docker-compose up` para construir las imágenes y levantar los dos contenedores. Docker se encargará de crear una red virtual para que la aplicación y la base de datos se puedan comunicar sin problemas.  
4. **Verificación:** Acceder a la aplicación web a través del navegador para confirmar que se conecta a la base de datos y funciona correctamente.

# Implementación

### **Objetivo del Proyecto**

El objetivo principal fue configurar una aplicación web en Python (usando el framework Flask) y conectarla a una base de datos PostgreSQL, todo dentro de contenedores de Docker.

### **Archivos de Configuración Finales**

Dejando de lado las primeras versiones de los archivos, estas son las que funcionaron.

#### **`docker-compose.yml`**

'''YAML  
version: '3.8'

services:  
  app:  
    build: .  
    ports:  
      \- "5000:5000"  
    depends\_on:  
      db:  
        condition: service\_healthy  
    environment:  
      DATABASE\_URL: postgresql://postgres:example@db:5432/mydatabase

  db:  
    image: postgres:16-alpine  
    volumes:  
      \- postgres\_data:/var/lib/postgresql/data/  
    environment:  
      POSTGRES\_USER: postgres  
      POSTGRES\_PASSWORD: example  
      POSTGRES\_DB: mydatabase  
    healthcheck:  
      test: \["CMD-SHELL", "pg\_isready \-U postgres"\]  
      interval: 5s  
      timeout: 5s  
      retries: 5

volumes:  
  postgres\_data:
'''


#### **`app.py`**

'''Python  
import os  
from flask import Flask, jsonify  
import psycopg2

app \= Flask(\_\_name\_\_)

@app.route('/')  
def index():  
    conn \= None  
    try:  
        conn \= psycopg2.connect(  
            os.environ.get('DATABASE\_URL')  
        )  
        cur \= conn.cursor()  
        cur.execute('SELECT 1')  
        test\_result \= cur.fetchone()\[0\]  
        cur.close()  
        return jsonify(message=f"Hello from Flask\! DB connection test: {test\_result}")  
    except Exception as e:  
        return jsonify(error=f"Error al conectar con la base de datos: {e}")  
    finally:  
        if conn:  
            conn.close()

if \_\_name\_\_ \== '\_\_main\_\_':  
    app.run(host='0.0.0.0')
'''


#### **`requirements.txt`**

'''Flask  
psycopg2-binary
'''

### **Pasos Finales y Comandos Clave**

Para ejecutar y gestionar el proyecto, estos son los comandos:

* **Para iniciar el proyecto en segundo plano y que no se detenga:** `sudo docker-compose up -d`  
* **Para detener el proyecto y los contenedores:** `sudo docker-compose down`  
* **Para reconstruir la aplicación después de hacer cambios en el código:** `sudo docker-compose up --build`  
* **Para ver qué contenedores están corriendo:** `sudo docker ps`

